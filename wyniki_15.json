 -------- result aggregate --------
{  "_id" : "PKR",  "totalBalancePerCurrency" : NumberDecimal("18938.00"),  "avarageBalance" : NumberDecimal("4734.50") }
{  "_id" : "NPR",  "totalBalancePerCurrency" : NumberDecimal("5792.26"),  "avarageBalance" : NumberDecimal("5792.26") }
{  "_id" : "ZMW",  "totalBalancePerCurrency" : NumberDecimal("5569.56"),  "avarageBalance" : NumberDecimal("5569.56") }
{  "_id" : "HRK",  "totalBalancePerCurrency" : NumberDecimal("24354.82"),  "avarageBalance" : NumberDecimal("4870.964") }
{  "_id" : "KRW",  "totalBalancePerCurrency" : NumberDecimal("13379.82"),  "avarageBalance" : NumberDecimal("6689.91") }
{  "_id" : "BOB",  "totalBalancePerCurrency" : NumberDecimal("5263.3"),  "avarageBalance" : NumberDecimal("5263.3") }
{  "_id" : "ISK",  "totalBalancePerCurrency" : NumberDecimal("4316.41"),  "avarageBalance" : NumberDecimal("4316.41") }
{  "_id" : "UZS",  "totalBalancePerCurrency" : NumberDecimal("3573.03"),  "avarageBalance" : NumberDecimal("3573.03") }
{  "_id" : "CUP",  "totalBalancePerCurrency" : NumberDecimal("15017.34"),  "avarageBalance" : NumberDecimal("5005.78") }
{  "_id" : "XOF",  "totalBalancePerCurrency" : NumberDecimal("17882.05"),  "avarageBalance" : NumberDecimal("5960.683333333333333333333333333333") }
{  "_id" : "LYD",  "totalBalancePerCurrency" : NumberDecimal("8764.99"),  "avarageBalance" : NumberDecimal("4382.495") }
{  "_id" : "CZK",  "totalBalancePerCurrency" : NumberDecimal("37156.42"),  "avarageBalance" : NumberDecimal("4644.5525") }
{  "_id" : "ARS",  "totalBalancePerCurrency" : NumberDecimal("23242.00"),  "avarageBalance" : NumberDecimal("4648.40") }
{  "_id" : "PYG",  "totalBalancePerCurrency" : NumberDecimal("4874.69"),  "avarageBalance" : NumberDecimal("4874.69") }
{  "_id" : "HNL",  "totalBalancePerCurrency" : NumberDecimal("16514.59"),  "avarageBalance" : NumberDecimal("5504.863333333333333333333333333333") }
{  "_id" : "BRL",  "totalBalancePerCurrency" : NumberDecimal("49632.02"),  "avarageBalance" : NumberDecimal("4512.001818181818181818181818181818") }
{  "_id" : "COP",  "totalBalancePerCurrency" : NumberDecimal("19746.73"),  "avarageBalance" : NumberDecimal("4936.6825") }
{  "_id" : "ILS",  "totalBalancePerCurrency" : NumberDecimal("16295.49"),  "avarageBalance" : NumberDecimal("5431.83") }
{  "_id" : "XAF",  "totalBalancePerCurrency" : NumberDecimal("14094.66"),  "avarageBalance" : NumberDecimal("4698.22") }
{  "_id" : "YER",  "totalBalancePerCurrency" : NumberDecimal("13712.50"),  "avarageBalance" : NumberDecimal("4570.833333333333333333333333333333") }
{  "_id" : "MXN",  "totalBalancePerCurrency" : NumberDecimal("50229.00"),  "avarageBalance" : NumberDecimal("5022.90") }
{  "_id" : "CAD",  "totalBalancePerCurrency" : NumberDecimal("58375.60"),  "avarageBalance" : NumberDecimal("5306.872727272727272727272727272727") }
{  "_id" : "RSD",  "totalBalancePerCurrency" : NumberDecimal("4276.56"),  "avarageBalance" : NumberDecimal("4276.56") }
{  "_id" : "VUV",  "totalBalancePerCurrency" : NumberDecimal("6418.27"),  "avarageBalance" : NumberDecimal("6418.27") }
{  "_id" : "MAD",  "totalBalancePerCurrency" : NumberDecimal("3818.85"),  "avarageBalance" : NumberDecimal("3818.85") }
{  "_id" : "TZS",  "totalBalancePerCurrency" : NumberDecimal("7052.37"),  "avarageBalance" : NumberDecimal("3526.185") }
{  "_id" : "VEF",  "totalBalancePerCurrency" : NumberDecimal("8333.28"),  "avarageBalance" : NumberDecimal("4166.64") }
{  "_id" : "GTQ",  "totalBalancePerCurrency" : NumberDecimal("5806.3"),  "avarageBalance" : NumberDecimal("5806.3") }
{  "_id" : "TJS",  "totalBalancePerCurrency" : NumberDecimal("4087.71"),  "avarageBalance" : NumberDecimal("4087.71") }
{  "_id" : "XPF",  "totalBalancePerCurrency" : NumberDecimal("4759.07"),  "avarageBalance" : NumberDecimal("4759.07") }
{  "_id" : "BGN",  "totalBalancePerCurrency" : NumberDecimal("21200.88"),  "avarageBalance" : NumberDecimal("5300.22") }
{  "_id" : "RUB",  "totalBalancePerCurrency" : NumberDecimal("119749.15"),  "avarageBalance" : NumberDecimal("4989.547916666666666666666666666667") }
{  "_id" : "CLP",  "totalBalancePerCurrency" : NumberDecimal("21008.95"),  "avarageBalance" : NumberDecimal("5252.2375") }
{  "_id" : "SRD",  "totalBalancePerCurrency" : NumberDecimal("5286.68"),  "avarageBalance" : NumberDecimal("5286.68") }
{  "_id" : "DOP",  "totalBalancePerCurrency" : NumberDecimal("20674.74"),  "avarageBalance" : NumberDecimal("5168.685") }
{  "_id" : "MGA",  "totalBalancePerCurrency" : NumberDecimal("14560.99"),  "avarageBalance" : NumberDecimal("4853.663333333333333333333333333333") }
{  "_id" : "USD",  "totalBalancePerCurrency" : NumberDecimal("74680.98"),  "avarageBalance" : NumberDecimal("4978.732") }
{  "_id" : "MNT",  "totalBalancePerCurrency" : NumberDecimal("21715.61"),  "avarageBalance" : NumberDecimal("5428.9025") }
{  "_id" : "KYD",  "totalBalancePerCurrency" : NumberDecimal("3760.89"),  "avarageBalance" : NumberDecimal("3760.89") }
{  "_id" : "ZAR",  "totalBalancePerCurrency" : NumberDecimal("11790.92"),  "avarageBalance" : NumberDecimal("3930.306666666666666666666666666667") }
{  "_id" : "MMK",  "totalBalancePerCurrency" : NumberDecimal("4629.42"),  "avarageBalance" : NumberDecimal("4629.42") }
{  "_id" : "RWF",  "totalBalancePerCurrency" : NumberDecimal("4632.88"),  "avarageBalance" : NumberDecimal("4632.88") }
{  "_id" : "IRR",  "totalBalancePerCurrency" : NumberDecimal("26504.24"),  "avarageBalance" : NumberDecimal("4417.373333333333333333333333333333") }
{  "_id" : "EUR",  "totalBalancePerCurrency" : NumberDecimal("245091.47"),  "avarageBalance" : NumberDecimal("4901.8294") }
{  "_id" : "IDR",  "totalBalancePerCurrency" : NumberDecimal("323922.59"),  "avarageBalance" : NumberDecimal("4907.918030303030303030303030303030") }
{  "_id" : "GBP",  "totalBalancePerCurrency" : NumberDecimal("6149.19"),  "avarageBalance" : NumberDecimal("6149.19") }
{  "_id" : "NOK",  "totalBalancePerCurrency" : NumberDecimal("4773.66"),  "avarageBalance" : NumberDecimal("4773.66") }
{  "_id" : "IQD",  "totalBalancePerCurrency" : NumberDecimal("4269.39"),  "avarageBalance" : NumberDecimal("4269.39") }
{  "_id" : "ALL",  "totalBalancePerCurrency" : NumberDecimal("3325.48"),  "avarageBalance" : NumberDecimal("3325.48") }
{  "_id" : "BYR",  "totalBalancePerCurrency" : NumberDecimal("5095.79"),  "avarageBalance" : NumberDecimal("5095.79") }
{  "_id" : "NZD",  "totalBalancePerCurrency" : NumberDecimal("5328.46"),  "avarageBalance" : NumberDecimal("5328.46") }
{  "_id" : "UAH",  "totalBalancePerCurrency" : NumberDecimal("40471.84"),  "avarageBalance" : NumberDecimal("5058.98") }
{  "_id" : "MKD",  "totalBalancePerCurrency" : NumberDecimal("3835.05"),  "avarageBalance" : NumberDecimal("3835.05") }
{  "_id" : "MWK",  "totalBalancePerCurrency" : NumberDecimal("3574.42"),  "avarageBalance" : NumberDecimal("3574.42") }
{  "_id" : "ZWL",  "totalBalancePerCurrency" : NumberDecimal("5792.17"),  "avarageBalance" : NumberDecimal("5792.17") }
{  "_id" : "NGN",  "totalBalancePerCurrency" : NumberDecimal("24946.23"),  "avarageBalance" : NumberDecimal("4157.705") }
{  "_id" : "THB",  "totalBalancePerCurrency" : NumberDecimal("23021.96"),  "avarageBalance" : NumberDecimal("4604.392") }
{  "_id" : "CNY",  "totalBalancePerCurrency" : NumberDecimal("470700.38"),  "avarageBalance" : NumberDecimal("4954.740842105263157894736842105263") }
{  "_id" : "PLN",  "totalBalancePerCurrency" : NumberDecimal("90770.78"),  "avarageBalance" : NumberDecimal("5042.821111111111111111111111111111") }
{  "_id" : "EGP",  "totalBalancePerCurrency" : NumberDecimal("5579.3"),  "avarageBalance" : NumberDecimal("5579.3") }
{  "_id" : "AMD",  "totalBalancePerCurrency" : NumberDecimal("24609.33"),  "avarageBalance" : NumberDecimal("4921.866") }
{  "_id" : "AFN",  "totalBalancePerCurrency" : NumberDecimal("16755.49"),  "avarageBalance" : NumberDecimal("5585.163333333333333333333333333333") }
{  "_id" : "SEK",  "totalBalancePerCurrency" : NumberDecimal("70840.19"),  "avarageBalance" : NumberDecimal("5060.013571428571428571428571428571") }
{  "_id" : "MYR",  "totalBalancePerCurrency" : NumberDecimal("4781.12"),  "avarageBalance" : NumberDecimal("4781.12") }
{  "_id" : "ETB",  "totalBalancePerCurrency" : NumberDecimal("5436.11"),  "avarageBalance" : NumberDecimal("5436.11") }
{  "_id" : "PHP",  "totalBalancePerCurrency" : NumberDecimal("118606.28"),  "avarageBalance" : NumberDecimal("4941.928333333333333333333333333333") }
{  "_id" : "BWP",  "totalBalancePerCurrency" : NumberDecimal("4076.29"),  "avarageBalance" : NumberDecimal("4076.29") }
{  "_id" : "CDF",  "totalBalancePerCurrency" : NumberDecimal("12228.8"),  "avarageBalance" : NumberDecimal("6114.4") }
{  "_id" : "JPY",  "totalBalancePerCurrency" : NumberDecimal("60944.74"),  "avarageBalance" : NumberDecimal("5078.728333333333333333333333333333") }
{  "_id" : "PEN",  "totalBalancePerCurrency" : NumberDecimal("18644.94"),  "avarageBalance" : NumberDecimal("4661.235") }
{  "_id" : "NIO",  "totalBalancePerCurrency" : NumberDecimal("9971.28"),  "avarageBalance" : NumberDecimal("4985.64") }
{  "_id" : "KZT",  "totalBalancePerCurrency" : NumberDecimal("3788.95"),  "avarageBalance" : NumberDecimal("3788.95") }
{  "_id" : "VND",  "totalBalancePerCurrency" : NumberDecimal("36160.26"),  "avarageBalance" : NumberDecimal("4520.0325") }
 -------- result map reduce --------
{  "results" : [ { "_id" : "AFN", "value" : { "total" : 16755.489999999998, "average" : 5585.163333333333 } }, { "_id" : "ALL", "value" : { "total" : 3325.48, "average" : 3325.48 } }, { "_id" : "AMD", "value" : { "total" : 24609.329999999998, "average" : 4921.866 } }, { "_id" : "ARS", "value" : { "total" : 23242, "average" : 4648.4 } }, { "_id" : "BGN", "value" : { "total" : 21200.879999999997, "average" : 5300.219999999999 } }, { "_id" : "BOB", "value" : { "total" : 5263.3, "average" : 5263.3 } }, { "_id" : "BRL", "value" : { "total" : 49632.02, "average" : 4512.001818181818 } }, { "_id" : "BWP", "value" : { "total" : 4076.29, "average" : 4076.29 } }, { "_id" : "BYR", "value" : { "total" : 5095.79, "average" : 5095.79 } }, { "_id" : "CAD", "value" : { "total" : 58375.600000000006, "average" : 5306.872727272727 } }, { "_id" : "CDF", "value" : { "total" : 12228.8, "average" : 6114.4 } }, { "_id" : "CLP", "value" : { "total" : 21008.95, "average" : 5252.2375 } }, { "_id" : "CNY", "value" : { "total" : 470700.3800000001, "average" : 4954.740842105264 } }, { "_id" : "COP", "value" : { "total" : 19746.73, "average" : 4936.6825 } }, { "_id" : "CUP", "value" : { "total" : 15017.34, "average" : 5005.78 } }, { "_id" : "CZK", "value" : { "total" : 37156.42, "average" : 4644.5525 } }, { "_id" : "DOP", "value" : { "total" : 20674.739999999998, "average" : 5168.6849999999995 } }, { "_id" : "EGP", "value" : { "total" : 5579.3, "average" : 5579.3 } }, { "_id" : "ETB", "value" : { "total" : 5436.11, "average" : 5436.11 } }, { "_id" : "EUR", "value" : { "total" : 245091.47, "average" : 4901.8294 } }, { "_id" : "GBP", "value" : { "total" : 6149.19, "average" : 6149.19 } }, { "_id" : "GTQ", "value" : { "total" : 5806.3, "average" : 5806.3 } }, { "_id" : "HNL", "value" : { "total" : 16514.59, "average" : 5504.863333333334 } }, { "_id" : "HRK", "value" : { "total" : 24354.82, "average" : 4870.964 } }, { "_id" : "IDR", "value" : { "total" : 323922.59, "average" : 4907.918030303031 } }, { "_id" : "ILS", "value" : { "total" : 16295.49, "average" : 5431.83 } }, { "_id" : "IQD", "value" : { "total" : 4269.39, "average" : 4269.39 } }, { "_id" : "IRR", "value" : { "total" : 26504.239999999998, "average" : 4417.373333333333 } }, { "_id" : "ISK", "value" : { "total" : 4316.41, "average" : 4316.41 } }, { "_id" : "JPY", "value" : { "total" : 60944.74, "average" : 5078.7283333333335 } }, { "_id" : "KRW", "value" : { "total" : 13379.82, "average" : 6689.91 } }, { "_id" : "KYD", "value" : { "total" : 3760.89, "average" : 3760.89 } }, { "_id" : "KZT", "value" : { "total" : 3788.95, "average" : 3788.95 } }, { "_id" : "LYD", "value" : { "total" : 8764.99, "average" : 4382.495 } }, { "_id" : "MAD", "value" : { "total" : 3818.85, "average" : 3818.85 } }, { "_id" : "MGA", "value" : { "total" : 14560.99, "average" : 4853.663333333333 } }, { "_id" : "MKD", "value" : { "total" : 3835.05, "average" : 3835.05 } }, { "_id" : "MMK", "value" : { "total" : 4629.42, "average" : 4629.42 } }, { "_id" : "MNT", "value" : { "total" : 21715.61, "average" : 5428.9025 } }, { "_id" : "MWK", "value" : { "total" : 3574.42, "average" : 3574.42 } }, { "_id" : "MXN", "value" : { "total" : 50228.99999999999, "average" : 5022.9 } }, { "_id" : "MYR", "value" : { "total" : 4781.12, "average" : 4781.12 } }, { "_id" : "NGN", "value" : { "total" : 24946.230000000003, "average" : 4157.705000000001 } }, { "_id" : "NIO", "value" : { "total" : 9971.28, "average" : 4985.64 } }, { "_id" : "NOK", "value" : { "total" : 4773.66, "average" : 4773.66 } }, { "_id" : "NPR", "value" : { "total" : 5792.26, "average" : 5792.26 } }, { "_id" : "NZD", "value" : { "total" : 5328.46, "average" : 5328.46 } }, { "_id" : "PEN", "value" : { "total" : 18644.94, "average" : 4661.235 } }, { "_id" : "PHP", "value" : { "total" : 118606.28, "average" : 4941.928333333333 } }, { "_id" : "PKR", "value" : { "total" : 18938, "average" : 4734.5 } }, { "_id" : "PLN", "value" : { "total" : 90770.78000000001, "average" : 5042.821111111112 } }, { "_id" : "PYG", "value" : { "total" : 4874.69, "average" : 4874.69 } }, { "_id" : "RSD", "value" : { "total" : 4276.56, "average" : 4276.56 } }, { "_id" : "RUB", "value" : { "total" : 119749.15000000001, "average" : 4989.547916666667 } }, { "_id" : "RWF", "value" : { "total" : 4632.88, "average" : 4632.88 } }, { "_id" : "SEK", "value" : { "total" : 70840.19, "average" : 5060.013571428572 } }, { "_id" : "SRD", "value" : { "total" : 5286.68, "average" : 5286.68 } }, { "_id" : "THB", "value" : { "total" : 23021.96, "average" : 4604.392 } }, { "_id" : "TJS", "value" : { "total" : 4087.71, "average" : 4087.71 } }, { "_id" : "TZS", "value" : { "total" : 7052.370000000001, "average" : 3526.1850000000004 } }, { "_id" : "UAH", "value" : { "total" : 40471.84, "average" : 5058.98 } }, { "_id" : "USD", "value" : { "total" : 74680.98, "average" : 4978.732 } }, { "_id" : "UZS", "value" : { "total" : 3573.03, "average" : 3573.03 } }, { "_id" : "VEF", "value" : { "total" : 8333.28, "average" : 4166.64 } }, { "_id" : "VND", "value" : { "total" : 36160.259999999995, "average" : 4520.032499999999 } }, { "_id" : "VUV", "value" : { "total" : 6418.27, "average" : 6418.27 } }, { "_id" : "XAF", "value" : { "total" : 14094.66, "average" : 4698.22 } }, { "_id" : "XOF", "value" : { "total" : 17882.05, "average" : 5960.683333333333 } }, { "_id" : "XPF", "value" : { "total" : 4759.07, "average" : 4759.07 } }, { "_id" : "YER", "value" : { "total" : 13712.5, "average" : 4570.833333333333 } }, { "_id" : "ZAR", "value" : { "total" : 11790.92, "average" : 3930.306666666667 } }, { "_id" : "ZMW", "value" : { "total" : 5569.56, "average" : 5569.56 } }, { "_id" : "ZWL", "value" : { "total" : 5792.17, "average" : 5792.17 } } ],  "timeMillis" : 78,  "counts" : {  "input" : 9877,  "emit" : 503,  "reduce" : 43,  "output" : 73 },  "ok" : 1 }
